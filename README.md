# Proxy
## Описание

Proxy — это gRPC прокси-сервис для загрузки превью (thumbnails) видеороликов с YouTube. При повторном запросе на тот же видеоролик сервис возвращает закэшированный ответ, используя SQLite в качестве временного хранилища. Также предоставляется клиентская утилита командной строки, которая принимает ссылки на видеоролики в качестве параметров. Утилита поддерживает ключ `--async` для асинхронной загрузки большого количества файлов.

## Требования

- Go версии 1.16 или выше
- SQLite3 для хранения кэша
- Протокол компилятор Protocol Buffers (`protoc`)
- Плагины для gRPC и Go для `protoc`

## Установка

### 1. Клонирование репозитория <br>
   Склонируйте репозиторий на ваше локальное устройство:

   ```bash
   git clone https://github.com/sytayav/Proxy.git
   ```
### 2. Установка зависимостей <br>
Перейдите в директорию проекта и установите необходимые зависимости:

   ```bash
   cd Proxy
   go mod download
   ```
### 3. Запуск сервера <br>
Запустите gRPC сервер, который будет обрабатывать запросы на загрузку превью:
   ```bash
   go run cmd/server/main.go
   ```
### 4. Использование клиентской утилиты <br>
Клиентская утилита позволяет загружать превью видеороликов по их ссылкам. Для синхронной загрузки используйте:
   ```bash
   go run cmd/client/main.go <ссылка_на_видео_1> <ссылка_на_видео_2> ...
   ```
Для асинхронной загрузки добавьте флаг --async:
   ```bash
   go run cmd/client/main.go --async <ссылка_на_видео_1> <ссылка_на_видео_2> ...
   ```
### 5. Тестирование <br>
В проекте предусмотрены тесты для проверки корректности работы сервиса. Для их запуска выполните:
   ```bash
   go test ./test/...
   ```
## Структура проекта <br>
- .github/workflows — пайплайн для тестирования кода (GitHub Actions)
- api/ — сгенерированный gRPC код на основе .proto файла, протокол Buffers файл с определением сервиса для загрузки превью видео.. <br>
- cmd/server/ — реализация и запуск gRPC сервера. <br>
- cmd/client/ — реализация клиентской утилиты командной строки. <br>
- internal/db/ — логика работы с базой данных SQLite. <br>
- internal/thumbnail/ — логика загрузки и кэширования превью видеороликов. <br>
- pkg/utils — общие вспомогательные функции, используемые в проекте.
## Дополнительная информация <br>
- Загруженные превью будут храниться в папке `Proxy/thumbnail/`